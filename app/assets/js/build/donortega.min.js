"use strict";console.info("Don Ortega --- BigCommerce");var app=angular.module("bcDonOrtega",["ngAnimate","ngTouch","ui.bootstrap","ui.router"]);app.config(["$stateProvider",function(a){var b=[{name:"store",url:"",templateUrl:"views/category.html"},{name:"category",url:"",templateUrl:"views/category.html"},{name:"product",url:"/product/{productId}",templateUrl:"views/product.html",resolve:{product:function(a,b){return a.getList().then(function(a){return a[b.productId]})}},controller:function(a,b){a.product=b}},{name:"cart",url:"/cart",templateUrl:"views/cart.html"}];b.forEach(function(b){a.state(b)})}]),app.controller("StoreCtrl",["$scope","$timeout","products",function(a,b,c){var d=this;d.cartCount=0,d.qtyToAdd=1,sessionStorage.getItem("bigcommerce-cart")?d.cart=JSON.parse(sessionStorage.getItem("bigcommerce-cart")):d.cart=[],c.getList().then(function(a){d.productList=a}),d.getProductIndex=function(a){return d.productList.findIndex(function(b){return angular.equals(b,a)})},d.qtyDecrease=function(){d.qtyToAdd>1&&d.qtyToAdd--},d.changeCart=function(a,c,e,f,g){var h=d.cart.findIndex(function(a){return angular.equals(a.product,c)});"add"===a?(h===-1?d.cart.push({product:c,qty:e}):d.cart[h].qty=d.cart[h].qty+e,f&&b(function(){angular.element(document.getElementById("MyCart")).triggerHandler("click")})):"remove"===a&&(d.cart.splice(h,1),g.stopPropagation()),sessionStorage.setItem("bigcommerce-cart",JSON.stringify(d.cart))},d.calculateTotal=function(){var a=0;return d.cart.forEach(function(b){a+=b.product.price*b.qty}),a}}]),app.service("products",["$http","$q",function(a,b){var c={};return c.getList=function(){return b(function(b,c){sessionStorage.getItem("bigcommerce-productList")?b(JSON.parse(sessionStorage.getItem("bigcommerce-productList"))):a.get("/assets/json/products.json").then(function(a){sessionStorage.setItem("bigcommerce-productList",JSON.stringify(a.data)),b(JSON.parse(sessionStorage.getItem("bigcommerce-productList")))},function(a){console.error("Failed to retrieve JSON:",a),c(a)})})},c}]);