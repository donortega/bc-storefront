"use strict";console.info("Don Ortega --- BigCommerce");var app=angular.module("bcDonOrtega",["ngAnimate","ngTouch","ui.bootstrap","ui.router"]);app.config(["$stateProvider",function(a){var b=[{name:"store",url:"",templateUrl:"views/category.html"},{name:"category",url:"",templateUrl:"views/category.html"},{name:"product",url:"/product/{productId}",templateUrl:"views/product.html",resolve:{product:function(a,b){return a.getList().then(function(a){return a[b.productId]})}},controller:function(a,b){a.product=b}},{name:"cart",url:"/cart",templateUrl:"views/cart.html"}];b.forEach(function(b){a.state(b)})}]),app.controller("StoreCtrl",["$scope","products",function(a,b){var c=this;c.cartCount=0,c.qtyToAdd=1,sessionStorage.getItem("bigcommerce-cart")?c.cart=JSON.parse(sessionStorage.getItem("bigcommerce-cart")):c.cart=[],b.getList().then(function(a){c.productList=a}),c.getProductIndex=function(a){return c.productList.findIndex(function(b){return angular.equals(b,a)})},c.qtyDecrease=function(){c.qtyToAdd>1&&c.qtyToAdd--},c.changeCart=function(a,b,d,e){var f=c.cart.findIndex(function(a){return angular.equals(a.product,b)});"add"===a?f===-1?c.cart.push({product:b,qty:d}):c.cart[f].qty=c.cart[f].qty+d:"remove"===a&&c.cart.splice(f,1),sessionStorage.setItem("bigcommerce-cart",JSON.stringify(c.cart)),e&&(c.cartIsOpen=!0)},c.calculateTotal=function(){var a=0;return c.cart.forEach(function(b){a+=b.product.price*b.qty}),a}}]),app.service("products",["$http","$q",function(a,b){var c={};return c.getList=function(){var c=b.defer();return sessionStorage.getItem("bigcommerce-productList")?c.resolve(JSON.parse(sessionStorage.getItem("bigcommerce-productList"))):a.get("/assets/json/products.json").then(function(a){sessionStorage.setItem("bigcommerce-productList",JSON.stringify(a.data)),c.resolve(JSON.parse(sessionStorage.getItem("bigcommerce-productList")))},function(a){console.error("Failed to retrieve JSON:",a)}),c.promise},c}]);